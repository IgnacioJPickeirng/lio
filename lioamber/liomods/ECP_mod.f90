!&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&IIIIIIIIIIIIIIIIII
      module ECP_mod
      implicit none
!valiables del namelist!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      logical :: ecpmode
      integer :: ecptypes
      character (len=30) :: tipeECP
      integer, dimension(128) :: ZlistECP
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!Datos de los ECP
	integer, dimension(118,0:5,10) :: nECP
	double precision, dimension(118,0:5,10) :: bECP, aECP
	integer, dimension(118,0:5) :: expnumbersECP
	integer, dimension(118) :: Zcore, Lmax

!&&&&&&&&&&&&&&&&&&&&&&&&&hasta aca testeado FFFFFFFFFFFFFFFFFFFFFFF



!parameters for radial integral of type 2
!alpha y betha contains coeficients for expantion of modified spherical bessel function
!of the first kind Mk(x) in terms of sinh(x)/x^i (betha(k+1,i) and cosh(x)/x^i (alpha(k,i))
!for k between 0 and 4, it is enought for energy calculations of functions s to g
	integer, parameter, dimension (4,4) :: alpha = (/1,0,1,0,0,-3,0,-10,0,0,15,0,0,0,0,-105/)
	integer, parameter, dimension (5,5) :: betha = (/1,0,1,0,1,0,-1,0,-6,0,0,0,3,0,45,0,0,0,-15,0,0,0,0,0,105/)

!Bni(j) contain the value of  int t^(n-2-j)*(exp)-c(t-ai)^2 + exp(-c(t+ai)^2) from 0 to inf
!Cni(j) contain the value of  int t^(n-2-j)*(exp)-c(t-ai)^2 - exp(-c(t+ai)^2) from 0 to inf
! rho(n) = int exp(-cr^2) * sinh(Ka*r)* sinh(Kb*r) r^n  dr  from 0 to inf
! sigma(n) = int exp(-cr^2) * sinh(Ka*r)* cosh(Kb*r) r^n  dr  from 0 to inf
! sigmaR(n) = int exp(-cr^2) * cosh(Ka*r)* sinh(Kb*r) r^n  dr  from 0 to inf
! tau(n) = int exp(-cr^2) * cosh(Ka*r)* cosh(Kb*r) r^n  dr  from 0 to inf
	DOUBLE PRECISION, dimension (-12:14) :: Bn1, Bn2, Cn1, Cn2, rho, tau, sigma, sigmaR
	DOUBLE PRECISION, dimension (-12:14) :: Bn,Cn
!Qnl1l2(n,l1,l2) = int Ml1(kA*r)* Ml2(kB*r)*r^n * exp(-cr^2) dr from 0 to inf
	DOUBLE PRECISION, dimension (0:10,0:4,0:4) :: Qnl1l2
!Qnl(n,l) = int Ml(k*r)*r^n * exp(-cr^2) dr from 0 to inf
        DOUBLE PRECISION, dimension (0:10,0:4) :: Qnl
!Parameters
	DOUBLE PRECISION, parameter :: pi=3.14159265358979312D0, pi12=1.77245385090552D0 !pi12 = pi^0.5
!factorial
	integer, dimension(-1:15) :: fac = (/1,1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,1932053504,1278945280,2004310016/)
!test
	INTEGER, PARAMETER  :: dp = SELECTED_REAL_KIND(12, 60)

!variables para integrales angulares
!li contains the coeficiente ul,m,lx,ly,lz fof expansion of Normalized real spherical harmonics Slm in terms of 
!unitary sphere polinomials
!S(l,m)= sum ul,m,lx,ly,lz  (x/r)^lx * (y/r)^ly * (z/r)^lz               / lx+ly+lz=l
!ul=F(f(lx,ly,lz),m)
        DOUBLE PRECISION, dimension (1) :: l0 = (/0.5d0/pi12/)
	!l0 chequeado
	Double precision, parameter :: aux1=sqrt(3.d0)/(2*pi12)
	DOUBLE PRECISION, dimension (3,-1:1) :: l1=(/0.d0,aux1,0.d0,aux1,0.d0,0.d0,0.d0,0.d0,aux1/)
	!l1 chequeado
        Double precision, parameter :: aux2= 0.5d0 * sqrt(15.d0/pi)
        Double precision, parameter :: aux3= 0.25d0 * sqrt(5.d0/pi)
	DOUBLE PRECISION, dimension (6,-2:2) :: l2=(/0.d0,0.d0,0.d0,0.d0,aux2,0.d0,0.d0,aux2,0.d0,0.d0,0.d0,0.d0,2*aux3,0.d0,-aux3,0.d0,0.d0,-aux3,0.d0,0.d0,0.d0,aux2,0.d0,0.d0,0.d0,0.d0,-0.5d0*aux2,0.d0,0.d0,0.5d0*aux2/)
	!l2 chekeado
	Double precision, parameter :: aux4=0.25d0 * sqrt(17.5d0/pi)
	Double precision, parameter :: aux5=0.5d0 * sqrt(105.d0/pi)
	Double precision, parameter :: aux6=sqrt(10.5d0/pi)
	Double precision, parameter :: aux7=sqrt(7.0d0/pi)
	DOUBLE PRECISION, dimension (10,-3:3) :: l3=(/0.d0,0.d0,0.d0,-aux4,0.d0,0.d0,0.d0,0.d0,3.d0*aux4,0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,aux5,0.d0,0.d0,0.d0,0.d0,0.d0,aux6,0.d0,-0.25d0*aux6,0.d0,0.d0,0.d0,0.d0,-0.25d0*aux6,0.d0,0.5d0*aux7,0.d0,-0.75d0*aux7,0.d0,0.d0,0.d0,0.d0,-0.75d0*aux7,0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,aux6,0.d0,-0.25*aux6,0.d0,0.d0,-0.25d0*aux6,0.d0,0.d0,-0.5d0*aux5,0.d0,0.d0,0.d0,0.d0,0.5d0*aux5,0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,-3.d0*aux4,0.d0,0.d0,aux4/)
	!l3 chekeado
!intangular devuelve el valor de la integral (x/r)^i (y/r)^j (z/r)^k para i,j,k entre 0 y 5. para valores fuera de ese rango usar la funcion: angularint(i,j,k)
	DOUBLEPRECISION,dimension(0:5,0:5,0:5)::intangular=(/12.5663706143592,0.000000000000000E+000,4.18879020478639,0.000000000000000E+000,2.51327412287183,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,4.18879020478639,0.000000000000000E+000,0.837758040957278,0.000000000000000E+000,0.359039160410262,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,2.51327412287183,0.000000000000000E+000,0.359039160410262,0.000000000000000E+000,0.119679720136754,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,4.18879020478639,0.000000000000000E+000,0.837758040957278,0.000000000000000E+000,0.359039160410262,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.837758040957278,0.000000000000000E+000,0.119679720136754,0.000000000000000E+000,3.989324004558467E-002,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.359039160410262,0.000000000000000E+000,3.989324004558467E-002,0.000000000000000E+000,1.087997455788673E-002,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,2.51327412287183,0.000000000000000E+000,0.359039160410262,0.000000000000000E+000,0.119679720136754,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.359039160410262,0.000000000000000E+000,3.989324004558467E-002,0.000000000000000E+000,1.087997455788673E-002,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.119679720136754,0.000000000000000E+000,1.087997455788673E-002,0.000000000000000E+000,2.510763359512322E-003,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000,0.000000000000000E+000/)

	Contains

!&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&IIIIIIIIIII

        subroutine asignacion(Z,simb)
!Toma el numero atomico (Z)  y devuelve el simbolo del elemento en mayusculas (simb)
        implicit none
        integer,intent(in) :: Z
        character, intent(out) :: simb*3
        character (len=3), dimension(118) :: vec
        vec=(/'H', 'HE', 'LI', 'BE', 'B', 'C', 'N', 'O', 'F', 'NE', 'NA', 'MG', 'AL', 'SI', 'P', 'S', 'CL', 'AR', 'K', 'CA', 'SC', 'TI', 'V', 'CR', 'MN', 'FE', 'CO', 'NI', 'CU', 'ZN', 'GA', 'GE', 'AS', 'SE', 'BR', 'KR', 'RB', 'SR', 'Y', 'ZR', 'NB', 'MO', 'TC', 'RU', 'RH', 'PD', 'AG', 'CD', 'IN', 'SN', 'SB', 'TE', 'I', 'XE', 'CS', 'BA', 'LA', 'CE', 'PR', 'ND', 'PM', 'SM', 'EU', 'GD', 'TB', 'DY', 'HO', 'ER', 'TM', 'YB', 'LU', 'HF', 'TA', 'W', 'RE', 'OS', 'IR', 'PT', 'AU', 'HG', 'TL', 'PB', 'BI', 'PO', 'AT', 'RN', 'FR', 'RA', 'AC', 'TH', 'PA', 'U', 'NP', 'PU', 'AM', 'CM', 'BK', 'CF', 'ES', 'FM', 'MD', 'NO', 'LR', 'RF', 'DB', 'SG', 'BH', 'HS', 'MT', 'DS', 'UUU', 'UUB', 'UUT', 'UUQ', 'UUP', 'UUH', 'UUS', 'UUO'/)
        simb=vec(Z)
        return
        end subroutine asignacion

!&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&FFFFFFFFFFFFFFFF




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
!!!!ROBADAS DE GAMESSSS

      DOUBLE PRECISION FUNCTION DAWF(Y)
!C es mucho mas lenta que DAW!!!!!!!!!!!!!!!!!
!la dejo por si hay q testear algo mas
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
!C
	integer, dimension(40) :: IFRST,ILAST
	integer :: nx, i1, il, k
      COMMON /DAWFCM/ C(249)
!C
!C        -----  ROUTINE EVALUATES THE DAWSON FUNCTION -----
!C        JOSE SIERRA HAS TESTED THIS ROUTINE AGAINST THE NAG LIBRARY,
!C        AND FINDS RELATIVE DISCREPANCIES LIE BELOW 1.E-10.  THE
!C        INTERVAL H IS SMALLER HERE, SO JOSE THINKS THIS ROUTINE
!C        MAY BE THE MORE CORRECT ONE.
!C
      PARAMETER (ZER=0.0D+00, ZP5=0.5D+00, ONE=1.0D+00, TEN=10.0D+00)
!C
      H = 0.25D+00
!C ... 0.00 < X <= 0.25  INTERVAL NO. 1, ABS.ERROR = 1.6571632954765D-
      IFRST( 1)= 1
      ILAST( 1)= 8
      C( 1)=-0.1587492209085D-15
      C( 2)= 0.1000000001679D+01
      C( 3)=-0.2200140634227D-06
      C( 4)=-0.6666582802511D+00
      C( 5)=-0.1406923341036D-03
      C( 6)= 0.2678610335986D+00
      C( 7)=-0.5192471402032D-02
      C( 8)=-0.6640836596489D-01
!C ... 0.25 < X <= 0.50  INTERVAL NO. 2, ABS.ERROR = 3.1585400961376D-
      IFRST( 2)= 9
      ILAST( 2)=16
      C( 9)=-0.1012320887742D-04
      C(10)= 0.1000229551438D+01
      C(11)=-0.2249318275452D-02
      C(12)=-0.6542497725108D+00
      C(13)=-0.4207802992979D-01
      C(14)= 0.3555122257011D+00
      C(15)=-0.1112488455006D+00
      C(16)=-0.8490860462189D-02
!C ... 0.50 < X <= 0.75  INTERVAL NO. 3, ABS.ERROR = 1.5242918038894D-
      IFRST( 3)=17
      ILAST( 3)=24
      C(17)=-0.4921356497286D-03
      C(18)= 0.1006613917835D+01
      C(19)=-0.3889997394948D-01
      C(20)=-0.5358795704274D+00
      C(21)=-0.2746372044452D+00
      C(22)= 0.6337005279825D+00
      C(23)=-0.2989429214171D+00
      C(24)= 0.4661336966923D-01
!C ... 0.75 < X <= 1.00  INTERVAL NO. 4, ABS.ERROR = 9.9014130228170D-
      IFRST( 4)=25
      ILAST( 4)=32
      C(25)= 0.2895369459824D-03
      C(26)= 0.1001188430399D+01
      C(27)=-0.2450339520101D-01
      C(28)=-0.5518735978257D+00
      C(29)=-0.2745338921003D+00
      C(30)= 0.6506738753191D+00
      C(31)=-0.3141764870712D+00
      C(32)= 0.5101503644671D-01
!C ... 1.00 < X <= 1.25  INTERVAL NO. 5, ABS.ERROR = 1.8118839761883D-
      IFRST( 5)=33
      ILAST( 5)=40
      C(33)= 0.4002056337725D-01
      C(34)= 0.7312836053563D+00
      C(35)= 0.7635870948288D+00
      C(36)=-0.1834201228325D+01
      C(37)= 0.9813999234300D+00
      C(38)=-0.8984573983721D-01
      C(39)=-0.7076886296272D-01
      C(40)= 0.1660415104457D-01
!C ... 1.25 < X <= 1.50  INTERVAL NO. 6, ABS.ERROR = 8.9031004790741D-
      IFRST( 6)=41
      ILAST( 6)=48
      C(41)= 0.1852097215132D+00
      C(42)=-0.7878409599634D-01
      C(43)= 0.2705240106371D+01
      C(44)=-0.4425988758096D+01
      C(45)= 0.3062214704197D+01
      C(46)=-0.1094631867084D+01
      C(47)= 0.1994346954993D+00
      C(48)=-0.1461141450065D-01
!C ... 1.50 < X <= 1.75  INTERVAL NO. 7, ABS.ERROR = 2.2932766796657D-
      IFRST( 7)=49
      ILAST( 7)=56
      C(49)= 0.2566795947043D+00
      C(50)=-0.4340789653964D+00
      C(51)= 0.3460647185102D+01
      C(52)=-0.5316677310217D+01
      C(53)= 0.3691359889577D+01
      C(54)=-0.1360915547303D+01
      C(55)= 0.2619748477425D+00
      C(56)=-0.2090002809252D-01
!C ... 1.75 < X <= 2.00  INTERVAL NO. 8, ABS.ERROR = 5.7358562344234D-
      IFRST( 8)=57
      ILAST( 8)=64
      C(57)=-0.2953293234440D+00
      C(58)= 0.1741536362797D+01
      C(59)=-0.2179107446162D+00
      C(60)=-0.1857700863729D+01
      C(61)= 0.1737803495672D+01
      C(62)=-0.6982079451638D+00
      C(63)= 0.1369430933680D+00
      C(64)=-0.1077900614057D-01
!C ... 2.00 < X <= 2.25  INTERVAL NO. 9, ABS.ERROR = 7.9634077110313D-
      IFRST( 9)=65
      ILAST( 9)=71
      C(65)=-0.1683235354314D+01
      C(66)= 0.6579307910802D+01
      C(67)=-0.7452680221211D+01
      C(68)= 0.4159630869064D+01
      C(69)=-0.1268324481886D+01
      C(70)= 0.2038507675752D+00
      C(71)=-0.1359998434782D-01
!C ... 2.25 < X <= 2.50  INTERVAL NO.10, ABS.ERROR = 4.9522164147220D-
      IFRST(10)=72
      ILAST(10)=78
      C(72)=-0.1172884307439D+01
      C(73)= 0.5243170888632D+01
      C(74)=-0.5994671204809D+01
      C(75)= 0.3310821796507D+01
      C(76)=-0.9902715162510D+00
      C(77)= 0.1552556976676D+00
      C(78)=-0.1006003345052D-01
!C ... 2.50 < X <= 2.75  INTERVAL NO.11, ABS.ERROR = 4.0683012514364D-
      IFRST(11)=79
      ILAST(11)=85
      C(79)= 0.2453071419396D+00
      C(80)= 0.1843675794804D+01
      C(81)=-0.2597381166786D+01
      C(82)= 0.1499064046402D+01
      C(83)=-0.4464691670097D+00
      C(84)= 0.6815297792976D-01
      C(85)=-0.4243532816569D-02
!C ... 2.75 < X <= 3.00  INTERVAL NO.12, ABS.ERROR = 1.7797319173951D-
      IFRST(12)=86
      ILAST(12)=92
      C(86)= 0.1711553394682D+01
      C(87)=-0.1366851519128D+01
      C(88)= 0.3331226440003D+00
      C(89)= 0.7176989090082D-01
      C(90)=-0.5525697253082D-01
      C(91)= 0.1093749119900D-01
      C(92)=-0.7553007453680D-03
!C ... 3.00 < X <= 3.25  INTERVAL NO.13, ABS.ERROR = 3.6681768733615D-
      IFRST(13)=93
      ILAST(13)=99
      C(93)= 0.2517095374277D+01
      C(94)=-0.2990903746754D+01
      C(95)= 0.1697891140418D+01
      C(96)=-0.5401196813139D+00
      C(97)= 0.9911334144514D-01
      C(98)=-0.9840574037905D-02
      C(99)= 0.4103935013215D-03
!C ... 3.25 < X <= 3.50  INTERVAL NO.14, ABS.ERROR = 1.1128875598843D-
      IFRST(14)=100
      ILAST(14)=106
      C(100)= 0.2590851813134D+01
      C(101)=-0.3134054423500D+01
      C(102)= 0.1813437074513D+01
      C(103)=-0.5897752524597D+00
      C(104)= 0.1110979078173D+00
      C(105)=-0.1138103745567D-01
      C(106)= 0.4927876094977D-03
!C ... 3.50 < X <= 3.75  INTERVAL NO.15, ABS.ERROR = 1.4752643551219D-
      IFRST(15)=107
      ILAST(15)=113
      C(107)= 0.2263419843285D+01
      C(108)=-0.2574296380066D+01
      C(109)= 0.1414605080120D+01
      C(110)=-0.4381747671623D+00
      C(111)= 0.7867466333846D-01
      C(112)=-0.7681612002974D-02
      C(113)= 0.3168638795614D-03
!C ... 3.75 < X <= 4.00  INTERVAL NO.16, ABS.ERROR = 9.2281737806843D-
      IFRST(16)=114
      ILAST(16)=120
      C(114)= 0.1858711024930D+01
      C(115)=-0.1925962656395D+01
      C(116)= 0.9817358192129D+00
      C(117)=-0.2839951967696D+00
      C(118)= 0.4777651946157D-01
      C(119)=-0.4378302333256D-02
      C(120)= 0.1696776598692D-03
!C ... 4.00 < X <= 4.25  INTERVAL NO.17, ABS.ERROR = 2.0758506025231D-
      IFRST(17)=121
      ILAST(17)=126
      C(121)= 0.1097210930469D+01
      C(122)=-0.8018697789038D+00
      C(123)= 0.2901340972873D+00
      C(124)=-0.5698500686831D-01
      C(125)= 0.5849148664856D-02
      C(126)=-0.2469443250448D-03
!C ... 4.25 < X <= 4.50  INTERVAL NO.18, ABS.ERROR = 1.1124878795954D-
      IFRST(18)=127
      ILAST(18)=132
      C(127)= 0.9640388573940D+00
      C(128)=-0.6448585002328D+00
      C(129)= 0.2160731515099D+00
      C(130)=-0.3951479965599D-01
      C(131)= 0.3788248790079D-02
      C(132)=-0.1496796030551D-03
!C ... 4.50 < X <= 4.75  INTERVAL NO.19, ABS.ERROR = 6.3691274476696D-
      IFRST(19)=133
      ILAST(19)=138
      C(133)= 0.8660393462895D+00
      C(134)=-0.5357754986697D+00
      C(135)= 0.1674970705868D+00
      C(136)=-0.2869722599326D-01
      C(137)= 0.2583548621624D-02
      C(138)=-0.9600615594536D-04
!C ... 4.75 < X <= 5.00  INTERVAL NO.20, ABS.ERROR = 3.8777869804107D-
      IFRST(20)=139
      ILAST(20)=144
      C(139)= 0.7902176622367D+00
      C(140)=-0.4558460385033D+00
      C(141)= 0.1337881166153D+00
      C(142)=-0.2158806335901D-01
      C(143)= 0.1833781835739D-02
      C(144)=-0.6437185220420D-04
!C ... 5.00 < X <= 5.25  INTERVAL NO.21, ABS.ERROR = 2.4793500585929D-
      IFRST(21)=145
      ILAST(21)=150
      C(145)= 0.7290485015677D+00
      C(146)=-0.3946016171968D+00
      C(147)= 0.1092568925649D+00
      C(148)=-0.1667445598850D-01
      C(149)= 0.1341617573053D-02
      C(150)=-0.4465044476092D-04
!C ... 5.25 < X <= 5.50  INTERVAL NO.22, ABS.ERROR = 1.6431300764452D-
      IFRST(22)=151
      ILAST(22)=156
      C(151)= 0.6781842728186D+00
      C(152)=-0.3461083410440D+00
      C(153)= 0.9076148811696D-01
      C(154)=-0.1314693754430D-01
      C(155)= 0.1005185194663D-02
      C(156)=-0.3181416541338D-04
!C ... 5.50 < X <= 5.75  INTERVAL NO.23, ABS.ERROR = 1.1226575225010D-
      IFRST(23)=157
      ILAST(23)=162
      C(157)= 0.6349565075405D+00
      C(158)=-0.3067740750644D+00
      C(159)= 0.7644330701296D-01
      C(160)=-0.1054064526443D-01
      C(161)= 0.7679512928007D-03
      C(162)=-0.2317565958947D-04
!C ... 5.75 < X <= 6.00  INTERVAL NO.24, ABS.ERROR = 7.8470563380506D-
      IFRST(24)=163
      ILAST(24)=168
      C(163)= 0.5976070486768D+00
      C(164)=-0.2742697363056D+00
      C(165)= 0.6512705037617D-01
      C(166)=-0.8570589057672D-02
      C(167)= 0.5964494688669D-03
      C(168)=-0.1720306463540D-04
!C ... 6.00 < X <= 6.25  INTERVAL NO.25, ABS.ERROR = 5.6132876125048D-
      IFRST(25)=169
      ILAST(25)=174
      C(169)= 0.5649180454987D+00
      C(170)=-0.2470090261752D+00
      C(171)= 0.5603266263223D-01
      C(172)=-0.7053466938578D-02
      C(173)= 0.4698947566794D-03
      C(174)=-0.1297991257161D-04
!C ... 6.25 < X <= 6.50  INTERVAL NO.26, ABS.ERROR = 3.5389913222161D-
      IFRST(26)=175
      ILAST(26)=179
      C(175)= 0.4314398767018D+00
      C(176)=-0.1418342842259D+00
      C(177)= 0.2288200151943D-01
      C(178)=-0.1828741476402D-02
      C(179)= 0.5815166332468D-04
!C ... 6.50 < X <= 6.75  INTERVAL NO.27, ABS.ERROR = 2.7426949600340D-
      IFRST(27)=180
      ILAST(27)=184
      C(180)= 0.4119346702408D+00
      C(181)=-0.1298244601295D+00
      C(182)= 0.2010878728234D-01
      C(183)=-0.1544113849832D-02
      C(184)= 0.4719618664240D-04
!C ... 6.75 < X <= 7.00  INTERVAL NO.28, ABS.ERROR = 2.1502799540940D-
      IFRST(28)=185
      ILAST(28)=189
      C(185)= 0.3942461802274D+00
      C(186)=-0.1193370928285D+00
      C(187)= 0.1777693657917D-01
      C(188)=-0.1313662248549D-02
      C(189)= 0.3865502003464D-04
!C ... 7.00 < X <= 7.25  INTERVAL NO.29, ABS.ERROR = 1.7034818000639D-
      IFRST(29)=190
      ILAST(29)=194
      C(190)= 0.3781177456714D+00
      C(191)=-0.1101165554215D+00
      C(192)= 0.1580007215659D-01
      C(193)=-0.1125279834923D-02
      C(194)= 0.3192276744812D-04
!C ... 7.25 < X <= 7.50  INTERVAL NO.30, ABS.ERROR = 1.3624212868990D-
      IFRST(30)=195
      ILAST(30)=199
      C(195)= 0.3633408065001D+00
      C(196)=-0.1019602554247D+00
      C(197)= 0.1411174419289D-01
      C(198)=-0.9699476170226D-03
      C(199)= 0.2656330616446D-04
!C ... 7.50 < X <= 7.75  INTERVAL NO.31, ABS.ERROR = 1.0990319765369D-
      IFRST(31)=200
      ILAST(31)=204
      C(200)= 0.3497439218126D+00
      C(201)=-0.9470569276499D-01
      C(202)= 0.1266017939918D-01
      C(203)=-0.8408550675085D-03
      C(204)= 0.2225784919574D-04
!C ... 7.75 < X <= 8.00  INTERVAL NO.32, ABS.ERROR = 8.9381835266522D-
      IFRST(32)=205
      ILAST(32)=209
      C(205)= 0.3371845853069D+00
      C(206)=-0.8822105128463D-01
      C(207)= 0.1140456233287D-01
      C(208)=-0.7327946570967D-03
      C(209)= 0.1877023896668D-04
!C ... 8.00 < X <= 8.25  INTERVAL NO.33, ABS.ERROR = 7.3210326689832D-
      IFRST(33)=210
      ILAST(33)=214
      C(210)= 0.3255431584494D+00
      C(211)=-0.8239832407718D-01
      C(212)= 0.1031237441518D-01
      C(213)=-0.6417393667562D-03
      C(214)= 0.1592339503986D-04
!C ... 8.25 < X <= 8.50  INTERVAL NO.34, ABS.ERROR = 6.0371707633067D-
      IFRST(34)=215
      ILAST(34)=219
      C(215)= 0.3147180811939D+00
      C(216)=-0.7714810368023D-01
      C(217)= 0.9357439877093D-02
      C(218)=-0.5645414814808D-03
      C(219)= 0.1358301324217D-04
!C ... 8.50 < X <= 8.75  INTERVAL NO.35, ABS.ERROR = 5.0113246885530D-
      IFRST(35)=220
      ILAST(35)=224
      C(220)= 0.3046231027165D+00
      C(221)=-0.7239608540250D-01
      C(222)= 0.8518560948886D-02
      C(223)=-0.4987218951555D-03
      C(224)= 0.1164632612927D-04
!C ... 8.75 < X <= 9.00  INTERVAL NO.36, ABS.ERROR = 4.1842085352073D-
      IFRST(36)=225
      ILAST(36)=229
      C(225)= 0.2951839772317D+00
      C(226)=-0.6807982796391D-01
      C(227)= 0.7778392737741D-02
      C(228)=-0.4423078514719D-03
      C(229)= 0.1003385659715D-04
!C ... 9.00 < X <= 9.25  INTERVAL NO.37, ABS.ERROR = 3.5125236053091D-
      IFRST(37)=230
      ILAST(37)=234
      C(230)= 0.2863364933588D+00
      C(231)=-0.6414655846973D-01
      C(232)= 0.7122648855400D-02
      C(233)=-0.3937177713169D-03
      C(234)= 0.8683627129358D-05
!C ... 9.25 < X <= 9.50  INTERVAL NO.38, ABS.ERROR = 2.9645175203541D-
      IFRST(38)=235
      ILAST(38)=239
      C(235)= 0.2780246155388D+00
      C(236)=-0.6055132372497D-01
      C(237)= 0.6539470823348D-02
      C(238)=-0.3516734769846D-03
      C(239)= 0.7546893357357D-05
!C ... 9.50 < X <= 9.75  INTERVAL NO.39, ABS.ERROR = 2.5142110615661D-
      IFRST(39)=240
      ILAST(39)=244
      C(240)= 0.2701996594546D+00
      C(241)=-0.5725581832360D-01
      C(242)= 0.6018987049956D-02
      C(243)=-0.3151372568482D-03
      C(244)= 0.6585092705791D-05
!C ... 9.75 < X <= 10.0  INTERVAL NO.40, ABS.ERROR = 2.1422863483167D-
      IFRST(40)=245
      ILAST(40)=249
      C(245)= 0.2628187673463D+00
      C(246)=-0.5422707501601D-01
      C(247)= 0.5552907092188D-02
      C(248)=-0.2832594125266D-03
      C(249)= 0.5767453330918D-05






      X= Y
      S= ONE
      IF(X.GE.ZER) GO TO 105
      X=-Y
      S=-ONE
  105 IF(X.GE.TEN) GO TO 115
      XN = X/H
      NX = INT(XN)+1
      I1 = IFRST(NX)
      IL = ILAST(NX)
      T= C(IL)
      DO 110 K=IL-1,I1,-1
  110 T= C(K)+T*X
      DAWF  = T*S
      RETURN
!C
!C        LARGE X EXPANSION
!C        THE ORIGINAL PROGRAM HAD AN IL=3 EXPANSION, SHOWN BELOW.
!C        THE RELATIVE ACCURACY IS IMPROVED FROM 3.E-9 TO 7.E-15
!C
  115 CONTINUE
      X2I = ONE/(X*X)
      IL = 8
      TXT=(IL +ZP5)*X2I
      SUM= TXT
      DO 120 K=IL,1,-1
         TXT= TXT-X2I
  120 SUM= TXT*(ONE+SUM)
      DAWF = Y*TXT*(ONE+SUM)
      RETURN
!C
!C---    X2I = ONE/(X*X)
!C---    TXT = X2I*ZP5
!C---    TX3 = X2I+TXT
!C---    TX5 = X2I+TX3
!C---    TX7 = X2I+TX5
!C---    DAWF  = Y*TXT*(ONE+TXT*(ONE+TX3*(ONE+TX5*(ONE+TX7))))
!C
      END function DAWF





      DOUBLE PRECISION FUNCTION DAWERF(Y)
!C    robada de gamesss
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
	integer NX, I1, IL, K
	integer, dimension (40) :: IFRST, ILAST
!C
      COMMON /DERFCM/ C(246),H
!C
!C     -----  ROUTINE EVALUATES THE HYBRID DAWSON-ERROR FUNCTION  -----
!C
      PARAMETER (ZP5=0.5D+00, ONE=1.0D+00, TEN=10.0D+00)
!C
!      X= ABS(Y)
!      IF(X.GE.TEN) GO TO 115
!C
!      XN = X/H
!      NX = INT(XN)+1
!      I1 = IFRST(NX)
!      IL = ILAST(NX)
!      T= C(IL)
!      DO 110 K=IL-1,I1,-1
!  110 T= C(K)+T*X
!      DAWERF= T
!      RETURN
!C
!C        LARGE X EXPANSION
!C        THE ORIGINAL PROGRAM HAD AN IL=4 EXPANSION, SHOWN BELOW.
!C        THE RELATIVE ACCURACY IS IMPROVED FROM 2.E-10 TO 7.E-15
!C
!  115 CONTINUE
!      X2I = ONE/(X*X)
!      IL = 8
!      TXT=(IL +ZP5)*X2I
!      SUM= TXT
!      DO 120 K=IL,1,-1
!         TXT= TXT-X2I
!  120 SUM= TXT*(ONE+SUM)
!      DAWERF= X*TXT*(ONE+SUM)
!      RETURN
!C
!C---    X2I = ONE/(X*X)
!C---    TXT = X2I*ZP5
!C---    TX3 = X2I+TXT
!C---    TX5 = X2I+TX3
!C---    TX7 = X2I+TX5
!C---    TX9 = X2I+TX7
!C---    DAWERF= X*TXT*(ONE+TXT*(ONE+TX3*(ONE+TX5*(ONE+TX7*(ONE+TX9)))))
!
!      END

!      SUBROUTINE DAWERT
!C
!      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
!C
!C        -----  ROUTINE ALLOCATES PARAMETERS SPECIFYING THE     -----
!C        -----  PIECEWISE CHEBYCHEV POLYNOMIAL FIT TO THE       -----
!C        -----  DAWSON-ERROR FUNCTION.                          -----
!C
!      COMMON /DERFCM/ C(246),IFRST(40),ILAST(40),H
!C
      H = 0.25D+00
!C ... 0.00 < X <= 0.25  INTERVAL NO. 1, ABS.ERROR = 3.0831115438446D-
      IFRST( 1)= 1
      ILAST( 1)= 8
      C( 1)=-0.2227673357873D-15
      C( 2)=-0.3603041588494D-08
      C( 3)= 0.5641900599881D+00
      C( 4)=-0.1855716761667D-04
      C( 5)=-0.3758028089842D+00
      C( 6)=-0.2937263239086D-02
      C( 7)= 0.1586735773807D+00
      C( 8)=-0.3712362707925D-01
!C ... 0.25 < X <= 0.50  INTERVAL NO. 2, ABS.ERROR = 1.6200374375330D-
      IFRST( 2)= 9
      ILAST( 2)=16
      C( 9)= 0.1654923320373D-05
      C(10)=-0.4283673776908D-04
      C(11)= 0.5646780085194D+00
      C(12)=-0.3216632920741D-02
      C(13)=-0.3626661648377D+00
      C(14)=-0.3697874666458D-01
      C(15)= 0.2103001701512D+00
      C(16)=-0.7233313577516D-01
!C ... 0.50 < X <= 0.75  INTERVAL NO. 3, ABS.ERROR = 2.6527224861184D-
      IFRST( 3)=17
      ILAST( 3)=24
      C(17)=-0.4909038422764D-03
      C(18)= 0.6169678713757D-02
      C(19)= 0.5309521767077D+00
      C(20)= 0.9902446632012D-01
      C(21)=-0.5497719612405D+00
      C(22)= 0.1699289458172D+00
      C(23)= 0.8215358267937D-01
      C(24)=-0.3800879631724D-01
!C ... 0.75 < X <= 1.00  INTERVAL NO. 4, ABS.ERROR = 2.1188384380366D-
      IFRST( 4)=25
      ILAST( 4)=32
      C(25)=-0.8860184581188D-02
      C(26)= 0.8182679610811D-01
      C(27)= 0.2361899484096D+00
      C(28)= 0.7408443731368D+00
      C(29)=-0.1393552470603D+01
      C(30)= 0.8398504617092D+00
      C(31)=-0.2153157176716D+00
      C(32)= 0.1898293835776D-01
!C ... 1.00 < X <= 1.25  INTERVAL NO. 5, ABS.ERROR = 1.0054179711005D-
      IFRST( 5)=33
      ILAST( 5)=40
      C(33)=-0.2622864777452D-01
      C(34)= 0.2070481292278D+00
      C(35)=-0.1517729522946D+00
      C(36)= 0.1410375745664D+01
      C(37)=-0.2088589931697D+01
      C(38)= 0.1273821623264D+01
      C(39)=-0.3662054027830D+00
      C(40)= 0.4151758125850D-01
!C ... 1.25 < X <= 1.50  INTERVAL NO. 6, ABS.ERROR = 1.2743583965857D-
      IFRST( 6)=41
      ILAST( 6)=48
      C(41)= 0.7652753217902D-01
      C(42)=-0.3496979906426D+00
      C(43)= 0.1142731303255D+01
      C(44)=-0.2641065409391D+00
      C(45)=-0.7870989692331D+00
      C(46)= 0.6659477061060D+00
      C(47)=-0.2082257760423D+00
      C(48)= 0.2389272621700D-01
!C ... 1.50 < X <= 1.75  INTERVAL NO. 7, ABS.ERROR = 3.2651215065016D-
      IFRST( 7)=49
      ILAST( 7)=55
      C(49)= 0.4634935721533D+00
      C(50)=-0.2162775089324D+01
      C(51)= 0.4787745789535D+01
      C(52)=-0.4340108008393D+01
      C(53)= 0.1951017416635D+01
      C(54)=-0.4390388356211D+00
      C(55)= 0.3981846570969D-01
!C ... 1.75 < X <= 2.00  INTERVAL NO. 8, ABS.ERROR = 8.9706020389713D-
      IFRST( 8)=56
      ILAST( 8)=63
      C(56)= 0.9892135872598D+00
      C(57)=-0.4311631180681D+01
      C(58)= 0.8556855041877D+01
      C(59)=-0.8017503990110D+01
      C(60)= 0.4106390132111D+01
      C(61)=-0.1197913275632D+01
      C(62)= 0.1884269501482D+00
      C(63)=-0.1248598098755D-01
!C ... 2.00 < X <= 2.25  INTERVAL NO. 9, ABS.ERROR = 3.1388225352202D-
      IFRST( 9)=64
      ILAST( 9)=71
      C(64)= 0.4508582229747D+00
      C(65)=-0.2475021032343D+01
      C(66)= 0.5870952943693D+01
      C(67)=-0.5834804573043D+01
      C(68)= 0.3041872702481D+01
      C(69)=-0.8863349469112D+00
      C(70)= 0.1377496059452D+00
      C(71)=-0.8952617645264D-02
!C ... 2.25 < X <= 2.50  INTERVAL NO.10, ABS.ERROR = 3.5207392556913D-
      IFRST(10)=72
      ILAST(10)=78
      C(72)=-0.2479150925527D+01
      C(73)= 0.6465442349154D+01
      C(74)=-0.5832144628726D+01
      C(75)= 0.2684557558935D+01
      C(76)=-0.6830155078836D+00
      C(77)= 0.9186854104822D-01
      C(78)=-0.5120121563474D-02
!C ... 2.50 < X <= 2.75  INTERVAL NO.11, ABS.ERROR = 1.5842438472191D-
      IFRST(11)=79
      ILAST(11)=85
      C(79)=-0.2550246682056D+01
      C(80)= 0.6663085650406D+01
      C(81)=-0.6057008239737D+01
      C(82)= 0.2819123791215D+01
      C(83)=-0.7278168845029D+00
      C(84)= 0.9975271609922D-01
      C(85)=-0.5693960934877D-02
!C ... 2.75 < X <= 3.00  INTERVAL NO.12, ABS.ERROR = 2.1390000881638D-
      IFRST(12)=86
      ILAST(12)=92
      C(86)=-0.1437322524459D+01
      C(87)= 0.4244945032011D+01
      C(88)=-0.3866819653025D+01
      C(89)= 0.1760657886042D+01
      C(90)=-0.4399493394691D+00
      C(91)= 0.5797869518089D-01
      C(92)=-0.3166941925883D-02
!C ... 3.00 < X <= 3.25  INTERVAL NO.13, ABS.ERROR = 1.2176926134089D-
      IFRST(13)=93
      ILAST(13)=99
      C(93)= 0.4326982515539D-01
      C(94)= 0.1278541925538D+01
      C(95)=-0.1389457146276D+01
      C(96)= 0.6567745067205D+00
      C(97)=-0.1631568799154D+00
      C(98)= 0.2094831465123D-01
      C(99)=-0.1101922864715D-02
!C ... 3.25 < X <= 3.50  INTERVAL NO.14, ABS.ERROR = 4.2543746303636D-
      IFRST(14)=100
      ILAST(14)=106
      C(100)= 0.1115286202567D+01
      C(101)=-0.7098356509943D+00
      C(102)= 0.1477452918517D+00
      C(103)= 0.2274875774917D-01
      C(104)=-0.1601072077271D-01
      C(105)= 0.2728999281923D-02
      C(106)=-0.1616695274909D-03
!C ... 3.50 < X <= 3.75  INTERVAL NO.15, ABS.ERROR = 2.3193003073629D-
      IFRST(15)=107
      ILAST(15)=112
      C(107)= 0.1346851272697D+01
      C(108)=-0.1125834241251D+01
      C(109)= 0.4583884751028D+00
      C(110)=-0.1007033665315D+00
      C(111)= 0.1153266357142D-01
      C(112)=-0.5427038297057D-03
!C ... 3.75 < X <= 4.00  INTERVAL NO.16, ABS.ERROR = 2.6108004647085D-
      IFRST(16)=113
      ILAST(16)=118
      C(113)= 0.1220883963156D+01
      C(114)=-0.9581085557663D+00
      C(115)= 0.3690371210149D+00
      C(116)=-0.7689811239270D-01
      C(117)= 0.8360797545174D-02
      C(118)=-0.3736140672117D-03
!C ... 4.00 < X <= 4.25  INTERVAL NO.17, ABS.ERROR = 1.7570833676928D-
      IFRST(17)=119
      ILAST(17)=124
      C(119)= 0.1079863694049D+01
      C(120)=-0.7816343308043D+00
      C(121)= 0.2806819253411D+00
      C(122)=-0.5477512389825D-01
      C(123)= 0.5590565502644D-02
      C(124)=-0.2348302397877D-03
!C ... 4.25 < X <= 4.50  INTERVAL NO.18, ABS.ERROR = 1.0521805648978D-
      IFRST(18)=125
      ILAST(18)=130
      C(125)= 0.9600857053756D+00
      C(126)=-0.6404875010594D+00
      C(127)= 0.2141383549717D+00
      C(128)=-0.3908625281056D-01
      C(129)= 0.3740753346938D-02
      C(130)=-0.1475725788623D-03
!C ... 4.50 < X <= 4.75  INTERVAL NO.19, ABS.ERROR = 6.2718719107124D-
      IFRST(19)=131
      ILAST(19)=136
      C(131)= 0.8652746664820D+00
      C(132)=-0.5349723088368D+00
      C(133)= 0.1671594028443D+00
      C(134)=-0.2862620440719D-01
      C(135)= 0.2576075398247D-02
      C(136)=-0.9569143876433D-04
!C ... 4.75 < X <= 5.00  INTERVAL NO.20, ABS.ERROR = 3.9639402871217D-
      IFRST(20)=137
      ILAST(20)=142
      C(137)= 0.7900679556534D+00
      C(138)=-0.4556957919175D+00
      C(139)= 0.1337277737706D+00
      C(140)=-0.2157594052042D-01
      C(141)= 0.1832563601783D-02
      C(142)=-0.6432286463678D-04
!C ... 5.00 < X <= 5.25  INTERVAL NO.21, ABS.ERROR = 2.4784618801732D-
      IFRST(21)=143
      ILAST(21)=148
      C(143)= 0.7290302365904D+00
      C(144)=-0.3945841937680D+00
      C(145)= 0.1092502418252D+00
      C(146)=-0.1667318620030D-01
      C(147)= 0.1341496314853D-02
      C(148)=-0.4464581143111D-04
!C ... 5.25 < X <= 5.50  INTERVAL NO.22, ABS.ERROR = 1.6431300764452D-
      IFRST(22)=149
      ILAST(22)=154
      C(149)= 0.6781821897825D+00
      C(150)=-0.3461064436915D+00
      C(151)= 0.9076079662805D-01
      C(152)=-0.1314681150288D-01
      C(153)= 0.1005173704471D-02
      C(154)=-0.3181374631822D-04
!C ... 5.50 < X <= 5.75  INTERVAL NO.23, ABS.ERROR = 1.1222134332911D-
      IFRST(23)=155
      ILAST(23)=160
      C(155)= 0.6349563489690D+00
      C(156)=-0.3067739392218D+00
      C(157)= 0.7644326048783D-01
      C(158)=-0.1054063730153D-01
      C(159)= 0.7679506117711D-03
      C(160)=-0.2317563630640D-04
!C ... 5.75 < X <= 6.00  INTERVAL NO.24, ABS.ERROR = 7.8559381222476D-
      IFRST(24)=161
      ILAST(24)=166
      C(161)= 0.5976075476333D+00
      C(162)=-0.2742701592908D+00
      C(163)= 0.6512719379650D-01
      C(164)=-0.8570613370193D-02
      C(165)= 0.5964515294181D-03
      C(166)=-0.1720313448459D-04
!C ... 6.00 < X <= 6.25  INTERVAL NO.25, ABS.ERROR = 4.6252335295094D-
      IFRST(25)=167
      ILAST(25)=171
      C(167)= 0.4530821605957D+00
      C(168)=-0.1556937202255D+00
      C(169)= 0.2621052097467D-01
      C(170)=-0.2184050212463D-02
      C(171)= 0.7237572572194D-04
!C ... 6.25 < X <= 6.50  INTERVAL NO.26, ABS.ERROR = 3.5389913222161D-
      IFRST(26)=172
      ILAST(26)=176
      C(172)= 0.4314398767018D+00
      C(173)=-0.1418342842259D+00
      C(174)= 0.2288200151943D-01
      C(175)=-0.1828741476402D-02
      C(176)= 0.5815166332468D-04
!C ... 6.50 < X <= 6.75  INTERVAL NO.27, ABS.ERROR = 2.7426949600340D-
      IFRST(27)=177
      ILAST(27)=181
      C(177)= 0.4119346702408D+00
      C(178)=-0.1298244601295D+00
      C(179)= 0.2010878728234D-01
      C(180)=-0.1544113849832D-02
      C(181)= 0.4719618664240D-04
!C ... 6.75 < X <= 7.00  INTERVAL NO.28, ABS.ERROR = 2.1502799540940D-
      IFRST(28)=182
      ILAST(28)=186
      C(182)= 0.3942461802274D+00
      C(183)=-0.1193370928285D+00
      C(184)= 0.1777693657917D-01
      C(185)=-0.1313662248549D-02
      C(186)= 0.3865502003464D-04
!C ... 7.00 < X <= 7.25  INTERVAL NO.29, ABS.ERROR = 1.7034818000639D-
      IFRST(29)=187
      ILAST(29)=191
      C(187)= 0.3781177456714D+00
      C(188)=-0.1101165554215D+00
      C(189)= 0.1580007215659D-01
      C(190)=-0.1125279834923D-02
      C(191)= 0.3192276744812D-04
!C ... 7.25 < X <= 7.50  INTERVAL NO.30, ABS.ERROR = 1.3624212868990D-
      IFRST(30)=192
      ILAST(30)=196
      C(192)= 0.3633408065001D+00
      C(193)=-0.1019602554247D+00
      C(194)= 0.1411174419289D-01
      C(195)=-0.9699476170226D-03
      C(196)= 0.2656330616446D-04
!C ... 7.50 < X <= 7.75  INTERVAL NO.31, ABS.ERROR = 1.0990319765369D-
      IFRST(31)=197
      ILAST(31)=201
      C(197)= 0.3497439218126D+00
      C(198)=-0.9470569276499D-01
      C(199)= 0.1266017939918D-01
      C(200)=-0.8408550675085D-03
      C(201)= 0.2225784919574D-04
!C ... 7.75 < X <= 8.00  INTERVAL NO.32, ABS.ERROR = 8.9381835266522D-
      IFRST(32)=202
      ILAST(32)=206
      C(202)= 0.3371845853069D+00
      C(203)=-0.8822105128463D-01
      C(204)= 0.1140456233287D-01
      C(205)=-0.7327946570967D-03
      C(206)= 0.1877023896668D-04
!C ... 8.00 < X <= 8.25  INTERVAL NO.33, ABS.ERROR = 7.3210326689832D-
      IFRST(33)=207
      ILAST(33)=211
      C(207)= 0.3255431584494D+00
      C(208)=-0.8239832407718D-01
      C(209)= 0.1031237441518D-01
      C(210)=-0.6417393667562D-03
      C(211)= 0.1592339503986D-04
!C ... 8.25 < X <= 8.50  INTERVAL NO.34, ABS.ERROR = 6.0371707633067D-
      IFRST(34)=212
      ILAST(34)=216
      C(212)= 0.3147180811939D+00
      C(213)=-0.7714810368023D-01
      C(214)= 0.9357439877093D-02
      C(215)=-0.5645414814808D-03
      C(216)= 0.1358301324217D-04
!C ... 8.50 < X <= 8.75  INTERVAL NO.35, ABS.ERROR = 5.0113246885530D-
      IFRST(35)=217
      ILAST(35)=221
      C(217)= 0.3046231027165D+00
      C(218)=-0.7239608540250D-01
      C(219)= 0.8518560948886D-02
      C(220)=-0.4987218951555D-03
      C(221)= 0.1164632612927D-04
!C ... 8.75 < X <= 9.00  INTERVAL NO.36, ABS.ERROR = 4.1842085352073D-
      IFRST(36)=222
      ILAST(36)=226
      C(222)= 0.2951839772317D+00
      C(223)=-0.6807982796391D-01
      C(224)= 0.7778392737741D-02
      C(225)=-0.4423078514719D-03
      C(226)= 0.1003385659715D-04
!C ... 9.00 < X <= 9.25  INTERVAL NO.37, ABS.ERROR = 3.5125236053091D-
      IFRST(37)=227
      ILAST(37)=231
      C(227)= 0.2863364933588D+00
      C(228)=-0.6414655846973D-01
      C(229)= 0.7122648855400D-02
      C(230)=-0.3937177713169D-03
      C(231)= 0.8683627129358D-05
!C ... 9.25 < X <= 9.50  INTERVAL NO.38, ABS.ERROR = 2.9645175203541D-
      IFRST(38)=232
      ILAST(38)=236
      C(232)= 0.2780246155388D+00
      C(233)=-0.6055132372497D-01
      C(234)= 0.6539470823348D-02
      C(235)=-0.3516734769846D-03
      C(236)= 0.7546893357357D-05
!C ... 9.50 < X <= 9.75  INTERVAL NO.39, ABS.ERROR = 2.5142110615661D-
      IFRST(39)=237
      ILAST(39)=241
      C(237)= 0.2701996594546D+00
      C(238)=-0.5725581832360D-01
      C(239)= 0.6018987049956D-02
      C(240)=-0.3151372568482D-03
      C(241)= 0.6585092705791D-05
!C ... 9.75 < X <= 10.0  INTERVAL NO.40, ABS.ERROR = 2.1422863483167D-
      IFRST(40)=242
      ILAST(40)=246
      C(242)= 0.2628187673463D+00
      C(243)=-0.5422707501601D-01
      C(244)= 0.5552907092188D-02
      C(245)=-0.2832594125266D-03
      C(246)= 0.5767453330918D-05


      X= ABS(Y)
      IF(X.GE.TEN) GO TO 115
!C
      XN = X/H
      NX = INT(XN)+1
      I1 = IFRST(NX)
      IL = ILAST(NX)
      T= C(IL)
      DO 110 K=IL-1,I1,-1
  110 T= C(K)+T*X
      DAWERF= T
      RETURN
!C
!C        LARGE X EXPANSION
!C        THE ORIGINAL PROGRAM HAD AN IL=4 EXPANSION, SHOWN BELOW.
!C        THE RELATIVE ACCURACY IS IMPROVED FROM 2.E-10 TO 7.E-15
!C
  115 CONTINUE
      X2I = ONE/(X*X)
      IL = 8
      TXT=(IL +ZP5)*X2I
      SUM= TXT
      DO 120 K=IL,1,-1
         TXT= TXT-X2I
  120 SUM= TXT*(ONE+SUM)
      DAWERF= X*TXT*(ONE+SUM)
      RETURN

      END function DAWERF


        DOUBLE PRECISION FUNCTION NEXTCOEF(sgn,n,cados,expo,c0coef,coefn1, coefn2)
!calcula el coef Bn y Cn, con n<2
!si sgn=1 calcula Bn; si sgn=-1 calcula Cn
        integer, intent(in) :: sgn,n
        DOUBLE PRECISION, intent(in) :: cados,expo,c0coef,coefn1, coefn2
        NEXTCOEF=(1+sgn*(-1)**(-n-1))*cados**(-n-1)*expo/fac(-n-1)-2*c0coef*coefn2 +cados*coefn1
!	write(*,*) (1+sgn*(-1)**(-n-1))*cados**(-n-1)*expo/fac(-n-1)/(-n-1),-2*c0coef*coefn2/(-n-1),cados*coefn1/(-n-1)
!	write(*,*) "n",n, "sgn", sgn, "(1+sgn*(-1)**(-n-1))", (1+sgn*(-1)**(-n-1))
	NEXTCOEF=NEXTCOEF/(-n-1)
        RETURN
        END Function NEXTCOEF



        recursive integer function facrecursive(N)
!esta rutina ya no esta en uso,fue suplantada por un array. la dejo por las dudas
        implicit none
        integer, intent(in) :: N
        if (n.eq.-1 .or. n.eq.0 .or. n.eq.1) then
        facrecursive=1
        else
        facrecursive=N*facrecursive(N-1)
        end if
        return
        end function facrecursive

        recursive integer*8 function doublefacrecursive(N)
!esta rutina no se utiliza, se reemplazara por un array
!la rutina funciona hasta N=19
        implicit none
        integer, intent(in) :: N
        if (n.eq.-1 .or. n.eq.0 .or. n.eq.1) then
        doublefacrecursive=1
	else if (n .gt. 33) then
		write(*,*) "Error in doble factorial routine, n greater than 33"
		write(*,*) "insuficient presicion"
        else
        doublefacrecursive=N*doublefacrecursive(N-2)
        end if
        return
        end function doublefacrecursive

	integer*8 function doublefac(N)
	implicit none
        integer, intent(in) :: N
	integer :: i
	doublefac=1
        if (n.gt.1) then
		do i=N,2,-2
			doublefac=doublefac*N
		end do
	end if
        return
        end function doublefac

	DOUBLE PRECISION function angularint(i,j,k)
	integer, intent(in) :: i,j,k
!	DOUBLE PRECISION, parameter :: pi=3.14159265358979312D0
!esta rutina calcula la integral (x/r)^i (y/r)^j (z/r)^k, luego sera reemplazada por un array
	if (mod(i,2) .eq. 0 .and. mod(j,2) .eq. 0 .and.mod(k,2) .eq. 0 ) then
        angularint=4*pi*doublefacrecursive(i-1)*doublefacrecursive(j-1)*doublefacrecursive(k-1)/doublefacrecursive(i+j+k+1)
	write(21,*) i+j+k+1,doublefacrecursive(i+j+k+1)
        else
        angularint=0.d0
        end if
	return
	end function angularint



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


	FUNCTION DAW(XX) RESULT(fn_val)
 
! Code converted using TO_F90 by Alan Miller
! Date: 2003-01-14  Time: 15:25:00
 
!----------------------------------------------------------------------

! This function program evaluates Dawson's integral,

!                       2  / x   2
!                     -x   |    t
!             F(x) = e     |   e    dt
!                          |
!                          / 0

!   for a real argument x.

!   The calling sequence for this function is

!                   Y=DAW(X)

!   The main computation uses rational Chebyshev approximations published
!   in Math. Comp. 24, 171-178 (1970) by Cody, Paciorek and Thacher.
!   This transportable program is patterned after the machine-dependent
!   FUNPACK program DDAW(X), but cannot match that version for efficiency or
!   accuracy.  This version uses rational approximations that are
!   theoretically accurate to about 19 significant decimal digits.
!   The accuracy achieved depends on the arithmetic system, the compiler,
!   the intrinsic functions, and proper selection of the machine-dependent
!   constants.

!*******************************************************************

! Explanation of machine-dependent constants.  Let

!   XINF   = largest positive machine number
!   XMIN   = the smallest positive machine number.
!   EPS    = smallest positive number such that 1+eps > 1.
!            Approximately  beta**(-p), where beta is the machine radix
!            and p is the number of significant base-beta digits in a
!            floating-point number.

! Then the following machine-dependent constants must be declared
!   in DATA statements.  IEEE values are provided as a default.

!   XMAX   = absolute argument beyond which DAW(X) underflows.
!            XMAX = min(0.5/xmin, xinf).
!   XSMALL = absolute argument below DAW(X)  may be represented
!            by X.  We recommend XSMALL = sqrt(eps).
!   XLARGE = argument beyond which DAW(X) may be represented by
!            1/(2x).  We recommend XLARGE = 1/sqrt(eps).

!     Approximate values for some important machines are

!                        beta  p     eps     xmin       xinf

!  CDC 7600      (S.P.)    2  48  7.11E-15  3.14E-294  1.26E+322
!  CRAY-1        (S.P.)    2  48  7.11E-15  4.58E-2467 5.45E+2465
!  IEEE (IBM/XT,
!    SUN, etc.)  (S.P.)    2  24  1.19E-07  1.18E-38   3.40E+38
!  IEEE (IBM/XT,
!    SUN, etc.)  (D.P.)    2  53  1.11D-16  2.23E-308  1.79D+308
!  IBM 3033      (D.P.)   16  14  1.11D-16  5.40D-79   7.23D+75
!  VAX 11/780    (S.P.)    2  24  5.96E-08  2.94E-39   1.70E+38
!                (D.P.)    2  56  1.39D-17  2.94D-39   1.70D+38
!   (G Format)   (D.P.)    2  53  1.11D-16  5.57D-309  8.98D+307

!                         XSMALL     XLARGE     XMAX

!  CDC 7600      (S.P.)  5.96E-08   1.68E+07  1.59E+293
!  CRAY-1        (S.P.)  5.96E-08   1.68E+07  5.65E+2465
!  IEEE (IBM/XT,
!    SUN, etc.)  (S.P.)  2.44E-04   4.10E+03  4.25E+37
!  IEEE (IBM/XT,
!    SUN, etc.)  (D.P.)  1.05E-08   9.49E+07  2.24E+307
!  IBM 3033      (D.P.)  3.73D-09   2.68E+08  7.23E+75
!  VAX 11/780    (S.P.)  2.44E-04   4.10E+03  1.70E+38
!                (D.P.)  3.73E-09   2.68E+08  1.70E+38
!   (G Format)   (D.P.)  1.05E-08   9.49E+07  8.98E+307

!*******************************************************************

! Error Returns

!  The program returns 0.0 for |X| > XMAX.

! Intrinsic functions required are:

!     ABS


!  Author: W. J. Cody
!          Mathematics and Computer Science Division
!          Argonne National Laboratory
!          Argonne, IL 60439

!  Latest modification: March 9, 1992

!----------------------------------------------------------------------

	IMPLICIT NONE
	INTEGER, PARAMETER  :: dp = SELECTED_REAL_KIND(12, 60)

	REAL (dp), INTENT(IN)  :: xx
	REAL (dp)              :: fn_val

! Local variables

	INTEGER    :: i
	REAL (dp)  :: frac, sump, sumq, w2, x, y
!----------------------------------------------------------------------
!  Mathematical constants.
!----------------------------------------------------------------------
	REAL (dp), PARAMETER  :: zero = 0.0_dp, half = 0.5_dp, one = 1.0_dp,  &
                         six25 = 6.25_dp, one225 = 12.25_dp, two5 = 25.0_dp
!----------------------------------------------------------------------
!  Machine-dependent constants
!----------------------------------------------------------------------
	REAL (dp), PARAMETER  :: XSMALL = 1.05D-08, XLARGE = 9.49D+07,   &
                         XMAX = 2.24D+307
!----------------------------------------------------------------------
!  Coefficients for R(9,9) approximation for  |x| < 2.5
!----------------------------------------------------------------------
	REAL (dp), PARAMETER  :: P1(10) = (/  &
        -2.69020398788704782410D-12, 4.18572065374337710778D-10,  &
        -1.34848304455939419963D-08, 9.28264872583444852976D-07,  &
        -1.23877783329049120592D-05, 4.07205792429155826266D-04,  &
        -2.84388121441008500446D-03, 4.70139022887204722217D-02,  &
        -1.38868086253931995101D-01, 1.00000000000000000004D+00 /)
	REAL (dp), PARAMETER  :: Q1(10) = (/  &
         1.71257170854690554214D-10, 1.19266846372297253797D-08,  &
         4.32287827678631772231D-07, 1.03867633767414421898D-05,  &
         1.78910965284246249340D-04, 2.26061077235076703171D-03,  &
         2.07422774641447644725D-02, 1.32212955897210128811D-01,  &
         5.27798580412734677256D-01, 1.00000000000000000000D+00 /)
!----------------------------------------------------------------------
!  Coefficients for R(9,9) approximation in J-fraction form
!     for  x in [2.5, 3.5)
!----------------------------------------------------------------------
	REAL (dp), PARAMETER  :: P2(10) = (/  &
        -1.70953804700855494930D+00,-3.79258977271042880786D+01,  &
         2.61935631268825992835D+01, 1.25808703738951251885D+01,  &
        -2.27571829525075891337D+01, 4.56604250725163310122D+00,  &
        -7.33080089896402870750D+00, 4.65842087940015295573D+01,  &
        -1.73717177843672791149D+01, 5.00260183622027967838D-01 /)
	REAL (dp), PARAMETER  :: Q2(9) = (/  &
         1.82180093313514478378D+00, 1.10067081034515532891D+03,  &
        -7.08465686676573000364D+00, 4.53642111102577727153D+02,  &
         4.06209742218935689922D+01, 3.02890110610122663923D+02,  &
         1.70641269745236227356D+02, 9.51190923960381458747D+02,  &
         2.06522691539642105009D-01 /)
!----------------------------------------------------------------------
!  Coefficients for R(9,9) approximation in J-fraction form
!     for  x in [3.5, 5.0]
!----------------------------------------------------------------------
	REAL (dp), PARAMETER  :: P3(10) = (/  &
        -4.55169503255094815112D+00,-1.86647123338493852582D+01,  &
        -7.36315669126830526754D+00,-6.68407240337696756838D+01,  &
         4.84507265081491452130D+01, 2.69790586735467649969D+01,  &
        -3.35044149820592449072D+01, 7.50964459838919612289D+00,  &
        -1.48432341823343965307D+00, 4.99999810924858824981D-01 /)
	REAL (dp), PARAMETER  :: Q3(9) = (/  &
         4.47820908025971749852D+01, 9.98607198039452081913D+01,  &
         1.40238373126149385228D+01, 3.48817758822286353588D+03,  &
        -9.18871385293215873406D+00, 1.24018500009917163023D+03,  &
        -6.88024952504512254535D+01,-2.31251575385145143070D+00,  &
         2.50041492369922381761D-01 /)
!----------------------------------------------------------------------
!  Coefficients for R(9,9) approximation in J-fraction form
!     for  |x| > 5.0
!----------------------------------------------------------------------
	REAL (dp), PARAMETER  :: P4(10) = (/  &
        -8.11753647558432685797D+00,-3.84043882477454453430D+01,  &
        -2.23787669028751886675D+01,-2.88301992467056105854D+01,  &
        -5.99085540418222002197D+00,-1.13867365736066102577D+01,  &
        -6.52828727526980741590D+00,-4.50002293000355585708D+00,  &
        -2.50000000088955834952D+00, 5.00000000000000488400D-01 /)
	REAL (dp), PARAMETER  :: Q4(9) = (/  &
         2.69382300417238816428D+02, 5.04198958742465752861D+01,  &
         6.11539671480115846173D+01, 2.08210246935564547889D+02,  &
         1.97325365692316183531D+01,-1.22097010558934838708D+01,  &
        -6.99732735041547247161D+00,-2.49999970104184464568D+00,  &
         7.49999999999027092188D-01 /)
!----------------------------------------------------------------------
	x = xx
	IF (ABS(x) > xlarge) THEN
	  IF (ABS(x) <= xmax) THEN
	    fn_val = half / x
	  ELSE
	    fn_val = zero
	  END IF
	ELSE IF (ABS(x) < xsmall) THEN
	  fn_val = x
	ELSE
	  y = x * x
	  IF (y < six25) THEN
!----------------------------------------------------------------------
!  ABS(X) .LT. 2.5
!----------------------------------------------------------------------
	    sump = p1(1)
	    sumq = q1(1)
	    DO  i = 2, 10
	      sump = sump * y + p1(i)
	      sumq = sumq * y + q1(i)
	    END DO
	    fn_val = x * sump / sumq
	  ELSE IF (y < one225) THEN
!----------------------------------------------------------------------
!  2.5 .LE. ABS(X) .LT. 3.5
!----------------------------------------------------------------------
	    frac = zero
	    DO  i = 1, 9
	      frac = q2(i) / (p2(i)+y+frac)
	    END DO
	    fn_val = (p2(10)+frac) / x
	  ELSE IF (y < two5) THEN
!----------------------------------------------------------------------
!  3.5 .LE. ABS(X) .LT. 5.0
!---------------------------------------------------------------------
	    frac = zero
	    DO  i = 1, 9
	      frac = q3(i) / (p3(i)+y+frac)
	    END DO
	    fn_val = (p3(10)+frac) / x
	  ELSE
!----------------------------------------------------------------------
!  5.0 .LE. ABS(X) .LE. XLARGE
!------------------------------------------------------------------
	    w2 = one / x / x
	    frac = zero
	    DO  i = 1, 9
	      frac = q4(i) / (p4(i)+y+frac)
	    END DO
	    frac = p4(10) + frac
	    fn_val = (half + half*w2*frac) / x
	  END IF
	END IF
	RETURN
!---------- Last line of DAW ----------
	END FUNCTION daw




	end module ECP_mod
